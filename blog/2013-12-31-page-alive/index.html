<!DOCTYPE html> <!--[if lt IE 7]><html lang=en class="no-js lt-ie9 lt-ie8 lt-ie7"><![endif]--> <!--[if IE 7]><html lang=en class="no-js lt-ie9 lt-ie8"><![endif]--> <!--[if IE 8]><html lang=en class="no-js lt-ie9"><![endif]--> <!--[if IE 9]><html lang=en class="no-js lt-ie10" lang=en><![endif]--> <!--[if gt IE 9]><!--> <html lang=en class=no-js> <!--<![endif]--> <head> <meta charset=utf-8 /> <!--[if lt IE 9]><meta http-equiv=X-UA-Compatible content="IE=edge"/><![endif]--> <title>Page Alive! | Tom Gillard - Melbourne web designer/developer</title> <meta name=viewport content="width=device-width, initial-scale=1.0"/> <meta name=HandheldFriendly content=True /> <meta name=MobileOptimized content=320 /> <link rel=apple-touch-icon-precomposed sizes=144x144 href="/img/core/apple-touch-icon-144x144-precomposed.png"/> <link rel=apple-touch-icon-precomposed sizes=114x114 href="/img/core/apple-touch-icon-114x114-precomposed.png"/> <link rel=apple-touch-icon-precomposed sizes=72x72 href="/img/core/apple-touch-icon-72x72-precomposed.png"/> <link rel=apple-touch-icon-precomposed sizes=57x57 href="/img/core/apple-touch-icon-72x72-precomposed.png"/> <link rel=apple-touch-icon-precomposed href="/img/core/apple-touch-icon-precomposed.png"/> <link rel="shortcut icon" href="/favicon.ico"/> <link href="/css/style.css" media=screen rel=stylesheet /> <meta name=description content=""/> <meta property="og:image" content="/img/elements/profile-large.png"/> <meta property="og:site_name" content="Tom Gillard"/> <meta property="og:type" content=blog /> <meta property="og:url" content="http://tomgillard.com/blog/2013-12-31-page-alive/"/> <meta property="og:title" content="Page Alive!"/> <meta name="twitter:card" content=summary /> <meta name="twitter:creator" content="@tom_gillard"> <meta name="twitter:url" content="http://tomgillard.com/blog/2013-12-31-page-alive/"> <meta name="twitter:title" content="Page Alive!"> <meta name="twitter:description" content="Middleman can generate dynamic pages with a data file, a template and a little configuration. Let me show you how."> <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]--> </head> <body id=js-smooth-state class=m-scene> <!--[if lt IE 8]><p class=chromeframe>You are using an outdated browser. <a href="//browsehappy.com/">Upgrade your browser today</a> or <a href="//www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p><![endif]--> <a href="#main" role=link title="Skip to main content" class=skipNavigation>Skip to main content</a> <header id=top class=header role=banner> <div class="container scene_element scene_element--fadeindown"> <a href="#site-nav" class="mobile-menu-btn mobile-menu-btn--open is-small small-txt">Menu</a> <div class=logo> <a href="/" title=home> <p class=logo__title><strong>Tom Gillard</strong></p> </a> </div> <nav id=site-nav class=nav role=navigation> <h2 class=outline-title>Primary Navigation</h2> <ul class=main-menu role=menu> <li role=menuitem class="mobile-menu-btn mobile-menu-btn--close is-small"><a href="#" class=small-txt>Close X</a></li> <li class=first role=menuitem> <a title="View articles" href="/">Blog</a> </li> <li role=menuitem> <a title="Browse by topic" href="/blog/topics">Topics</a> </li> <li class=last role=menuitem> <a title="About me" href="/about">About</a> </li> </ul> </nav> </div> </header> <div class=page-heading__wrapper> <div class=container> <h1 class=page-heading__title>Page Alive!</h1> <time datetime=2013-12-31 pubdate class=page-heading__tagline>December 31, 2013</time> </div> </div> <div id=main class=main role=main> <div class=container> <article class="article article--full" role=article> <p class=article__intro>Middleman can generate dynamic pages with a data file, a template and a little configuration. Let me show you how.</p> <div class=article__content> <p>I first stumbled across <a href="//middlemanapp.com/basics/dynamic-pages/">Middleman’s dynamic pages</a> feature on a freelance project I was working on for a friend of mine. The site was for a local event manager who wanted to showcase several (I think it was about 10) of their most recent events.</p> <p>Now I’m not a huge fan of manual coding and always look for ways to automate or reuse code so I really didn’t want to have to manually create all those pages.</p> <p>Unfortunately the Middleman demo is a little basic for what I needed but luckily for me with a bit of digging and some communication back and forth with one of Middleman’s contributors, <a href="//benhollis.net/about/">Ben Hollis</a>, I discovered the true power of dynamic pages.</p> <p>Like I mentioned in the intro, all you need is 3 key ingredients; a data file, a template and a couple of lines in your <code>config.rb</code> file.</p> <p>Here’s how I have implemented it.</p> <h2 id=data-file>1. Data file</h2> <p>On the same level as my source (and eventually build) directories I created a <code>data</code> directory. Within my newly created data directory I created a new YAML file called <code>projects.yml</code> (Middleman also supports JSON data).</p> <p>This YAML file contained all the data properties of a project and was to be used for looping through and outputting each project’s details into a template.</p> <p>Let’s say each project has a client, title, description and list of event manager’s responsibilities.</p> <p>Our <code>projects.yml</code> file looks something like this;</p> <pre class=code--block><code>  - client: client1
    title: "First project"
    description: "This is a description of the 1st project."
    responsibilities:
      "&lt;li&gt;catering&lt;/li&gt;
      &lt;li&gt;venue management&lt;/li&gt;
      &lt;li&gt;event staffing&lt;/li&gt;"
  
  - client: client2
    title: "Second project"
    description: "This is a description of the 2nd project."
    responsibilities:
      "&lt;li&gt;catering&lt;/li&gt;"
</code></pre> <h2 id=template>2. Template</h2> <p>In my project (within the source directory) I created a new directory called <code>projects</code> (as this is what I was going to be displaying). Inside the projects directory I created <code>template.html.erb</code>. This file is to be referenced in <code>config.rb</code> as the template to use for generating the individual project pages.</p> <p>The template looks like this;</p> <pre class=code--block><code>&lt;% p = locals[:project] %&gt;
&lt;div class="l-wrapper"&gt;
  &lt;div class="l-content"&gt;
    &lt;h2&gt;&lt;%= p[:title] %&gt;&lt;/h2&gt;
    &lt;%= p[:description] %&gt;
    &lt;p class="highlight"&gt;Key responsibilities:&lt;/p&gt;
    &lt;ul class="itemised-list"&gt;
	    &lt;%= p[:responsibilities] %&gt;
    &lt;/ul&gt;
  &lt;/div&gt;
&lt;/div&gt;
</code></pre> <p>Don’t worry about the <code>&lt;% p = locals[:project] %&gt;</code> at the top of the file, locals[:project] is defined in <code>config.rb</code> and will be explained in the next section.</p> <p>‘p’ stores the project data object and is then used to access each property of the project such as title, description and the list of responsibilities.</p> <h2 id=configuration>3. Configuration</h2> <p>The final piece of the puzzle lies in the <code>config.rb</code> file with this block;</p> <pre class=code--block><code>data.projects.each do |pd|
  proxy "/projects/#{pd[:client]}.html", "/projects/template.html", :layout =&gt; :popup, :locals =&gt; { :project =&gt; pd }, :ignore =&gt; true
end
</code></pre> <p>What this block is doing is as follows;</p> <p><strong>data.projects.each do |pd|</strong> is looping through each project item in <code>projects.yml</code></p> <p><strong>proxy</strong> is creating a dummy url using the client property of the project item within <code>projects.yml</code> and is being passed the template file in the projects directory. eg: “www.site.com/projects/client1.html”</p> <p><strong>layout</strong> is pointing to a custom layout which resides in the <code>layouts</code> directory and is different from the standard site layout.</p> <p><em>You can also set layout to false if your template has all the html in it (rather than using partial includes)</em></p> <p><strong>locals</strong> is what passes the data in <code>project.yml</code> to the template (remember p = locals[:projects])</p> <p><strong>ignore</strong> tells middleman not to create a html file for template.html.erb as we only want html files for each of the projects.</p> <p>So once that’s all setup all you need to do is fire up middleman server and test it out by going to; http://localhost:4567/projects/client1.html</p> <p>This really is a handy feature and you can get pretty creative with what you store in your data files and how you render that data in the template. Also, remember if you’re not too keen on YAML, Middleman also supports JSON.</p> <p>So go nuts and start adding dynamic pages to your not-so-static Middleman site!</p> <p>T</p> </div> <p> <strong>TOPICS:</strong> <a href="/blog/topics/middleman">middleman</a> <a href="/blog/topics/tutorial">tutorial</a> </p> </article> <ul class="list--clean list--article-nav"> <li class=prev> <a href="/blog/2013-12-30-page-by-numbers/" title="Previous article">&#171; <span class=is-small--inline>Previous Article</span></a> </li> <li class=next> <a href="/blog/2014-01-01-resolution-9/" title="Next article"><span class=is-small--inline>Next Article</span> &#187;</a> </li> </ul> </div> </div> <footer class=footer role=contentinfo> <div class=container> <div class=blurb> <div class=media> <img src="/img/elements/profile-mini.svg" onerror="this.onerror=null; this.src='/img/elements/profile-mini.png'" alt="" class="media__image blurb__headshot"/> <div class="media__body blurb__content"> <p>I'm Tom, a front end developer from Melbourne Australia.</p> <p>The thoughts and opinions on this site are all mine.</p> </div> </div> </div> <small>&copy; 2015 Tom Gillard.</small> <small class=is-large>Built with <a href="//middlemanapp.com" target=_blank>Middleman</a> using the <a href="//smacss.com/" target=_blank>SMACSS</a> css architecture.</small> <small id=contact>Feel free to grab the <a href="/feed.xml">feed</a> and/or <a href="//twitter.com/tom_gillard" target=_blank>follow me on Twitter</a>.</small> </div> </footer> <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script> + <script>!window.jQuery && document.write(unescape('%3Cscript src="/js/libs/jquery-1.9.1.min.js"%3E%3C/script%3E'));</script> <script src="js/site-scripts.js"></script> <script>
			var _gaq = _gaq || [];
			_gaq.push(['_setAccount', 'UA-27423893-2']);
			_gaq.push(['_trackPageview']);
			(function() {
				var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
				ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
			})();
		</script> </body> </html>